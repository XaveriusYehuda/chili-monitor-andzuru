(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function a(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(o){if(o.ep)return;o.ep=!0;const t=a(o);fetch(o.href,t)}})();const ce="SensorMonitorDB",de=1,f="humidityUpdates",y="phUpdates";let p;function le(){return new Promise((e,n)=>{const a=indexedDB.open(ce,de);a.onerror=i=>{console.error("Error opening IndexedDB:",i.target.errorCode),n(i.target.errorCode)},a.onsuccess=i=>{p=i.target.result,console.log("IndexedDB opened successfully"),e(p)},a.onupgradeneeded=i=>{const o=i.target.result;o.objectStoreNames.contains(y)||(o.createObjectStore(y,{keyPath:"id",autoIncrement:!0}),console.log(`Object store '${y}' created.`)),o.objectStoreNames.contains(f)||(o.createObjectStore(f,{keyPath:"id",autoIncrement:!0}),console.log(`Object store '${f}' created.`))}})}function ue(e){if(!p){console.warn("IndexedDB not open. Cannot save pH data.");return}if(!e||typeof e!="object"){console.warn("Invalid pH data. Not saving to IndexedDB.");return}"id"in e&&delete e.id;const i=p.transaction([y],"readonly").objectStore(y).openCursor(null,"prev");i.onsuccess=o=>{const t=o.target.result;if(t&&t.value.phValue===e.phValue){console.warn("pH data is a duplicate of the immediately previous record. Not saving.");return}const c=p.transaction([y],"readwrite").objectStore(y).add(e);c.onsuccess=()=>{console.log("pH data successfully saved to IndexedDB.")},c.onerror=d=>{console.error("Error saving pH data to IndexedDB:",d.target.errorCode)}},i.onerror=o=>{console.error("Error checking for duplicate pH data in IndexedDB:",o.target.errorCode)}}function me(e){if(!p){console.warn("IndexedDB not open. Cannot save humidity data.");return}if(!e||typeof e!="object"){console.warn("Invalid humidity data. Not saving to IndexedDB.");return}"id"in e&&delete e.id;const i=p.transaction([f],"readonly").objectStore(f).openCursor(null,"prev");i.onsuccess=o=>{const t=o.target.result;if(t&&t.value.humidityValue===e.humidityValue){console.warn("Humidity data is a duplicate of the immediately previous record. Not saving.");return}const c=p.transaction([f],"readwrite").objectStore(f).add(e);c.onsuccess=()=>{console.log("Humidity data successfully saved to IndexedDB.")},c.onerror=d=>{console.error("Error saving Humidity data to IndexedDB:",d.target.errorCode)}},i.onerror=o=>{console.error("Error checking for duplicate humidityValue in IndexedDB:",o.target.errorCode)}}function Z(e=8){return new Promise((n,a)=>{if(!p){console.warn("IndexedDB not open. Cannot get data."),n([]);return}const t=p.transaction([f],"readonly").objectStore(f).openCursor(null,"prev"),s=[];t.onsuccess=r=>{const c=r.target.result;c&&s.length<e?(s.push(c.value),c.continue()):n(s)},t.onerror=r=>{console.error("Error getting data from IndexedDB:",r.target.errorCode),a(r.target.errorCode)}})}function ee(e=8){return new Promise((n,a)=>{if(!p){console.warn("IndexedDB not open. Cannot get data."),n([]);return}const t=p.transaction([y],"readonly").objectStore(y).openCursor(null,"prev"),s=[];t.onsuccess=r=>{const c=r.target.result;c&&s.length<e&&(s.push(c.value),c.continue())},t.onerror=r=>{console.error("Error getting data from IndexedDB:",r.target.errorCode),a(r.target.errorCode)}})}function ge(e="ph_data.csv"){return new Promise((n,a)=>{if(!p){console.warn("IndexedDB not open. Cannot get data."),a("IndexedDB not open");return}const t=p.transaction([y],"readonly").objectStore(y).openCursor();let s=[],r=[],c=!0;t.onsuccess=d=>{const m=d.target.result;if(m){const u=m.value;c&&(r=Object.keys(u),s.push(r.join(",")),c=!1);const h=r.map(b=>{let l=u[b];return l===null||typeof l>"u"?"":typeof l=="string"&&(l.includes(",")||l.includes('"')||l.includes(`
`))?`"${l.replace(/"/g,'""')}"`:l}).join(",");s.push(h),m.continue()}else{console.log("semua data telah diiterasi");const u=s.join(`
`),h=new Blob([u],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(h),l=document.createElement("a");l.href=b,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(b),console.log(`Data exported to ${e}`),n()}},t.onerror=d=>{console.error("Error download data from IndexedDB:",d.target.errorCode),a(d.target.errorCode)}})}function pe(e="humidity_data.csv"){return new Promise((n,a)=>{if(!p){console.warn("IndexedDB not open. Cannot get data."),a("IndexedDB not open");return}const t=p.transaction([f],"readonly").objectStore(f).openCursor();let s=[],r=[],c=!0;t.onsuccess=d=>{const m=d.target.result;if(m){const u=m.value;c&&(r=Object.keys(u),s.push(r.join(",")),c=!1);const h=r.map(b=>{let l=u[b];return l===null||typeof l>"u"?"":typeof l=="string"&&(l.includes(",")||l.includes('"')||l.includes(`
`))?`"${l.replace(/"/g,'""')}"`:l}).join(",");s.push(h),m.continue()}else{console.log("semua data telah diiterasi");const u=s.join(`
`),h=new Blob([u],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(h),l=document.createElement("a");l.href=b,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(b),console.log(`Data exported to ${e}`),n()}},t.onerror=d=>{console.error("Error download data from IndexedDB:",d.target.errorCode),a(d.target.errorCode)}})}const he="ae2f0qpfo130e-ats.iot.ap-southeast-1.amazonaws.com",te="ap-southeast-1",be="ap-southeast-1:66f016b1-04c1-4719-8774-bf55d732f161";AWS.config.region=te;AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:be});let E;const fe=async()=>{try{await new Promise((n,a)=>{AWS.config.credentials.get(i=>{i?a(i):n()})}),console.log("✅ Cognito Credentials loaded.");const e=ye.getSignedUrl(he,te,AWS.config.credentials.accessKeyId,AWS.config.credentials.secretAccessKey,AWS.config.credentials.sessionToken);E=mqtt.connect(e,{reconnectPeriod:5e3,clientId:"webclient_"+Math.floor(Math.random()*1e4),protocol:"wss",clean:!0}),E.on("connect",()=>{console.log("✅ MQTT connected")}),E.on("error",n=>{console.error("❌ MQTT Error:",n)})}catch(e){console.error("❌ Gagal load Cognito credentials:",e)}};window.nyalakanPompa=()=>{if(!E||!E.connected){console.error("🚫 MQTT belum terkoneksi. Tidak bisa publish.");return}const e=moment().format("YYYY-MM-DD HH:mm:ss"),n=document.getElementById("flushButton");n.classList.add("opacity-80"),n.disabled=!0,n.textContent="Sending ...",setTimeout(()=>{n.textContent="Flushing ..."},2e3),setTimeout(()=>{n.classList.remove("opacity-80"),n.disabled=!1,n.textContent="Flush"},3e4);const a=JSON.stringify({action:"nyala"});E.publish("device/pompa",a,{qos:1},i=>{i?console.error("🚫 Publish error:",i):console.log("📤 Pompa nyala command dikirim pada",e)})};const ye={getSignedUrl:function(e,n,a,i,o){const t=new Date,s=t.toISOString().slice(0,10).replace(/-/g,""),r=t.toISOString().replace(/[:-]|\.\d{3}/g,""),c="iotdevicegateway",d="AWS4-HMAC-SHA256",m="GET",u="/mqtt",h=s+"/"+n+"/"+c+"/aws4_request",b="X-Amz-Algorithm="+d+"&X-Amz-Credential="+encodeURIComponent(a+"/"+h)+"&X-Amz-Date="+r+"&X-Amz-SignedHeaders=host",l="host:"+e+`
`,N=AWS.util.crypto.sha256("","hex"),j=m+`
`+u+`
`+b+`
`+l+`
host
`+N,k=d+`
`+r+`
`+h+`
`+AWS.util.crypto.sha256(j,"hex"),C=AWS.util.crypto.hmac(AWS.util.crypto.hmac(AWS.util.crypto.hmac(AWS.util.crypto.hmac("AWS4"+i,s,"buffer"),n,"buffer"),c,"buffer"),"aws4_request","buffer"),R=AWS.util.crypto.hmac(C,k,"hex");let P="wss://"+e+u+"?"+b+"&X-Amz-Signature="+R;return o&&(P+="&X-Amz-Security-Token="+encodeURIComponent(o)),P}};let v;const oe=()=>{if(v&&v.readyState!==WebSocket.CLOSED&&v.readyState!==WebSocket.CLOSING){console.log("WebSocket sudah aktif. Tidak membuat koneksi baru.");return}const e="wss://chili-monitor-data.andzuru.space";v=new WebSocket(e),v.onopen=async()=>{console.log("✅ WebSocket connected to",e)},v.onmessage=n=>{try{const a=JSON.parse(n.data);console.log("📨 Data diterima:",a);const{topic:i,data:o,chartData:t,timestamp:s}=a,{ph:r,humidity:c}=t||{};let d=null;if(r&&Array.isArray(r.timestamps)&&r.timestamps.length>0){let g=r.timestamps[r.timestamps.length-1];typeof g=="string"&&g?d=new Date(g).toISOString():typeof g=="number"&&!isNaN(g)&&(g<1e10&&(g*=1e3),d=new Date(g).toISOString())}let m=null;if(c&&Array.isArray(c.timestamps)&&c.timestamps.length>0){let g=c.timestamps[c.timestamps.length-1];typeof g=="string"&&g?m=new Date(g).toISOString():typeof g=="number"&&!isNaN(g)&&(g<1e10&&(g*=1e3),m=new Date(g).toISOString())}const u=Date.now(),h=isNaN(Number(s))?0:u-Number(s),b=isNaN(Number(s))?null:new Date(Number(s)+7*60*60*1e3).toISOString(),l=new Date(u+7*60*60*1e3).toISOString();let N,j;o&&(o.Kelembapan!==void 0&&o.Kelembapan!==null&&!isNaN(parseFloat(o.Kelembapan))?(window.latestRecordHumidity={timestampCloudReceived:b,timestampBrowserReceived:l,latency:parseFloat(h),humidityValue:parseFloat(o.Kelembapan),humidityDataReceivedAt:m},N=window.latestRecordHumidity):console.log("Kelembapan tidak ada pembaharuan data"),o.Ph!==void 0&&o.Ph!==null&&!isNaN(parseFloat(o.Ph))?(window.latestRecordPh={timestampCloudReceived:b,timestampBrowserReceived:l,latency:parseFloat(h),phValue:parseFloat(o.Ph),phDataReceivedAt:d},j=window.latestRecordPh):console.log("PH tidak ada pembaharuan data"));const k=parseFloat((o==null?void 0:o.Ph)??"NaN"),C=parseFloat((o==null?void 0:o.Kelembapan)??"NaN"),R=isNaN(k)?"N/A":k.toFixed(1),P=isNaN(C)?"N/A":C.toFixed(1),K=document.getElementById("phValue"),_=document.getElementById("humidityValue"),Y=document.getElementById("ground-good-status"),z=document.getElementById("ground-poor-status");if(!isNaN(k)&&!isNaN(C)&&(k>8.5||k<5.5||C>90||C<10)?(Y.classList.add("hidden"),z.classList.remove("hidden")):(z.classList.add("hidden"),Y.classList.remove("hidden")),K&&(K.textContent=R),_&&(_.textContent=P),t){if(r&&Array.isArray(r.timestamps)&&Array.isArray(r.values)){const g=r.timestamps.map(Number),F=r.values.map(Number);navigator.onLine?(Ce(g,F),ue(j)):ee(1).then(T=>{T&&T.length>0&&setTimeout(ke,200)})}if(c&&Array.isArray(c.timestamps)&&Array.isArray(c.values)){const g=c.timestamps.map(Number),F=c.values.map(Number);navigator.onLine?(Be(g,F),me(N)):Z(1).then(T=>{T&&T.length>0&&setTimeout(Ie,200)})}}}catch(a){console.error("❌ Error parsing WebSocket message:",a)}},v.onerror=n=>{console.error("⚠️ WebSocket error:",n)},v.onclose=n=>{console.warn(`⚠️ WebSocket disconnected. Code: ${n.code}, Reason: ${n.reason}`),setTimeout(()=>{console.log("🔁 Mencoba reconnect WebSocket..."),oe()},5e3)}},G="BEr7RhsHyH-U39qwfNHjCgsxD3_cBFL17xttbkvTWYbavxeJoED-IKkSf1Ui4CUYiIdGsNeknYBqeEjVuIFQgFc";function J(e){const n="=".repeat((4-e.length%4)%4),a=(e+n).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(a),o=new Uint8Array(i.length);for(let t=0;t<i.length;++t)o[t]=i.charCodeAt(t);return o}async function Q(e,n){if(!n)throw console.error("No auth token found"),new Error("Authentication token is missing.");const a="https://chili-monitor-data.andzuru.space/api/save-subscription";console.log("Preparing subscription data for backend...");const i=e.getKey("p256dh"),o=e.getKey("auth");if(!i||!o)throw console.error("Subscription keys are missing"),new Error("Subscription keys are missing");const t={endpoint:e.endpoint,keys:{p256dh:btoa(String.fromCharCode(...new Uint8Array(i))),auth:btoa(String.fromCharCode(...new Uint8Array(o)))}};console.log("Sending subscription to backend:",t);try{const s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(t)}),r=await s.json();if(!s.ok)throw console.error("Backend subscription error:",r),new Error(r.message||"Failed to send subscription to backend");return console.log("Backend subscription successful:",r),r}catch(s){throw console.error("Subscription error:",s),s}}async function X(e,n){if(!n)throw console.error("No auth token found"),new Error("Authentication token is missing.");const a="https://chili-monitor-data.andzuru.space/api/delete-subscription",i={endpoint:e};try{const o=await fetch(a,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(i)}),t=await o.json();if(!o.ok)throw new Error(t.message||"Failed to send unsubscription to backend");return console.log("Unsubscription sent to backend successfully:",t),t}catch(o){throw console.error("Error sending unsubscription to backend:",o),o}}async function $(){if(!("serviceWorker"in navigator)||!("PushManager"in window))return{supported:!1,subscribed:!1,error:"Push notification not supported"};try{const n=await(await navigator.serviceWorker.ready).pushManager.getSubscription();return{supported:!0,subscribed:!!n,subscriptionObject:n}}catch{return{supported:!0,subscribed:!1,error:"Failed to check subscription status."}}}function I(e){const n=document.getElementById("subscribeBtn"),a=document.getElementById("subscribeBtnMobile");n&&a&&(e?(n.textContent="Unsubscribe",n.classList.remove("text-primary","hover:text-tersier"),n.classList.add("bg-primary","px-6","text-white","rounded-full","transition-colors","hover:text-primary","hover:bg-white"),a.textContent="Unsubscribe",a.classList.remove("group-hover:text-tersier"),a.classList.add("bg-primary","px-6","text-white","rounded-full","transition-colors","hover:text-primary","hover:bg-white")):(n.textContent="Subscribe",n.classList.remove("bg-primary","px-6","text-white","rounded-full","hover:bg-white","hover:text-primary"),n.classList.add("text-primary","hover:text-tersier"),a.textContent="Subscribe",a.classList.remove("bg-primary","px-6","text-white","rounded-full","hover:bg-white","hover:text-primary"),a.classList.add("group-hover:text-tersier")))}async function Se(){if(!("serviceWorker"in navigator)||!("PushManager"in window)){console.warn("Push notification tidak didukung.");return}try{const e=await navigator.serviceWorker.register("/sw.js");if(console.log("Service Worker terdaftar:",e),await Notification.requestPermission()==="denied"){console.warn("Izin notifikasi tidak diberikan"),I(!1);return}const a=await $();I(a.subscribed)}catch(e){console.error("Gagal setup push notification:",e)}}function we(e=8){return Math.random().toString(36).substring(2,2+e)}async function ne(e=0){if(e>=5)return console.error("Failed to auto-register after multiple attempts due to duplicate username/email."),alert("Gagal melakukan registrasi otomatis setelah beberapa percobaan. Silakan coba lagi nanti."),!1;const a=we(6),i=`user${a}`,o=`user${a}@example.com`,t="password123";try{console.log(`Attempting to register with: Username=${i}, Email=${o}`);const s=await fetch("https://chili-monitor-data.andzuru.space/api/register-auto-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,email:o,password:t})}),r=await s.json();return s.ok&&r.success?(console.log("Registration successful, token received:",r.token),localStorage.setItem("userToken",r.token),localStorage.setItem("userToken_createdAt",Date.now()),alert("Registrasi berhasil! Anda telah otomatis login."),!0):s.status===409?(console.warn("Username or email already exists. Retrying with new random values."),ne(e+1)):(console.error("Registration failed:",r.message||"Unknown error",r),alert(`Registrasi gagal: ${r.message||"Terjadi kesalahan."}`),!1)}catch(s){return console.error("Error during registration:",s),alert("Terjadi kesalahan saat registrasi."),!1}}function ve(e){if(!e)return!1;try{const n=e.split(".");if(n.length!==3)return!1;const a=JSON.parse(atob(n[1]));if(a.exp){const i=Math.floor(Date.now()/1e3);if(a.exp<i)return console.log("Token expired locally."),!1}return!0}catch(n){return console.error("Error decoding or validating token locally:",n),!1}}document.addEventListener("DOMContentLoaded",async()=>{oe(),fe(),le().then(()=>{}).catch(t=>console.error("Failed to open IndexedDB:",t));let e=localStorage.getItem("userToken"),n=localStorage.getItem("userToken_createdAt");const a=24*60*60*1e3;if(e&&ve(e)&&Date.now()-n<a)console.log("Valid user token found in localStorage:",e);else if(console.log("No valid user token found or token expired/too old. Attempting to auto-register and login."),localStorage.removeItem("userToken"),localStorage.removeItem("userToken_createdAt"),await ne())e=localStorage.getItem("userToken"),console.log("Auto-registration and login successful. New Token:",e);else{console.error("Auto-registration and login failed. User cannot proceed without a token."),alert("Gagal mendapatkan sesi pengguna. Fungsi tertentu mungkin tidak bekerja.");return}await Se();const i=document.getElementById("subscribeBtn"),o=document.getElementById("subscribeBtnMobile");i&&i.addEventListener("click",async()=>{const t=localStorage.getItem("userToken");if(!t){alert("Sesi pengguna tidak ditemukan. Harap segarkan halaman untuk mendapatkan sesi baru.");return}const s=await $();if(s.subscribed)try{await X(s.subscriptionObject.endpoint,t),await s.subscriptionObject.unsubscribe(),console.log("Successfully unsubscribed!"),I(!1),alert("You have successfully unsubscribed from push notifications.")}catch(r){console.error("Error unsubscribing:",r),alert("Failed to unsubscribe. Please try again.")}else try{const r=await navigator.serviceWorker.ready,c=J(G),d=await r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:c});await Q(d,t),console.log("Successfully subscribed!"),I(!0),alert("You have successfully subscribed to push notifications!")}catch(r){console.error("Error subscribing:",r),alert("Failed to subscribe. Please ensure notifications are enabled and try again.")}}),o&&o.addEventListener("click",async()=>{const t=localStorage.getItem("userToken");if(!t){alert("Sesi pengguna tidak ditemukan. Harap segarkan halaman untuk mendapatkan sesi baru.");return}const s=await $();if(s.subscribed)try{await X(s.subscriptionObject.endpoint,t),await s.subscriptionObject.unsubscribe(),console.log("Successfully unsubscribed (Mobile)!"),I(!1),alert("You have successfully unsubscribed from push notifications.")}catch(r){console.error("Error unsubscribing (Mobile):",r),alert("Failed to unsubscribe. Please try again.")}else try{const r=await navigator.serviceWorker.ready,c=J(G),d=await r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:c});await Q(d,t),console.log("Successfully subscribed (Mobile)!"),I(!0),alert("You have successfully subscribed to push notifications!")}catch(r){console.error("Error subscribing (Mobile):",r),alert("Failed to subscribe. Please ensure notifications are enabled and try again.")}})});async function ke(){const e=await ee();if(!e||e.length===0){S.data.datasets[0].data=[],S.data.labels=[],S.update();return}const n=e.slice().reverse(),a=n.map(o=>{const t=new Date(o.phDataReceivedAt),s=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0"),d=String(t.getHours()).padStart(2,"0"),m=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${s}-${r}-${c} ${d}:${m}:${u}`}),i=n.map(o=>o.phValue);S.data.datasets[0].data=i,S.data.labels=a,S.update()}function Ce(e,n){function a(o){const t=new Date(o),s=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0"),d=String(t.getHours()).padStart(2,"0"),m=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${s}-${r}-${c} ${d}:${m}:${u}`}const i=e.map(o=>a(o));S.data.datasets[0].data=n,S.data.labels=i,S.update()}const De={labels:[],datasets:[{label:"Soil pH",data:[],borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",borderWidth:2}]},xe={type:"line",data:De,options:{scales:{y:{beginAtZero:!1}}}},S=new Chart(document.getElementById("myChart1"),xe);async function Ie(){const e=await Z();if(!e||e.length===0){w.data.datasets[0].data=[],w.data.labels=[],w.update();return}const n=e.slice().reverse(),a=n.map(o=>{const t=new Date(o.humidityDataReceivedAt),s=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0"),d=String(t.getHours()).padStart(2,"0"),m=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${s}-${r}-${c} ${d}:${m}:${u}`}),i=n.map(o=>o.humidityValue);w.data.datasets[0].data=i,w.data.labels=a,w.update()}function Be(e,n){function a(o){const t=new Date(o),s=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0"),d=String(t.getHours()).padStart(2,"0"),m=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");return`${s}-${r}-${c} ${d}:${m}:${u}`}const i=e.map(o=>a(o));console.log(i),w.data.datasets[0].data=n,w.data.labels=i,w.update()}const Ee={labels:[],datasets:[{label:"Soil Moisture",data:[],borderColor:"rgba(54, 162, 235, 1)",backgroundColor:"rgba(54, 162, 235, 0.2)",borderWidth:2}]},Ae={type:"line",data:Ee,options:{scales:{y:{beginAtZero:!1}}}},w=new Chart(document.getElementById("myChart"),Ae),H=document.querySelector("#hamburger"),U=document.querySelector("#nav-menu");H.addEventListener("click",function(){H.classList.toggle("hamburger-active"),U.classList.toggle("hidden")});window.addEventListener("click",function(e){e.target!=H&&e.target!=U&&(H.classList.remove("hamburger-active"),U.classList.add("hidden"))});const M=document.getElementById("modal-container-1"),O=document.getElementById("modal-container-2"),A=document.getElementById("modal-confirm-download-container"),L=document.getElementById("modal-confirm-download-alert"),Le=document.getElementById("modal-main"),Te=document.getElementById("modal-main-download"),re=document.getElementById("info-button"),ae=document.getElementById("close-modal"),D=document.getElementById("download-data"),W=document.getElementById("cancel-download"),V=document.getElementById("get-ph-data-modal"),q=document.getElementById("get-humidity-data-modal"),B=document.getElementById("content-download-modal"),se=document.getElementById("title-download-modal");let x=null;re.addEventListener("click",()=>{M.classList.remove("hidden"),O.classList.remove("hidden")});V.addEventListener("click",()=>{A.classList.remove("hidden"),L.classList.remove("hidden"),x="ph",se.textContent="Download PH Data",B.textContent="Do you want to download the pH data?"});q.addEventListener("click",()=>{A.classList.remove("hidden"),L.classList.remove("hidden"),x="humidity",se.textContent="Download Humidity Data",B.textContent="Do you want to download the humidity data?"});D.addEventListener("click",()=>{x==="ph"?(D.disabled=!0,B.textContent="Mengunduh data pH...",setTimeout(async()=>{await ge()},4e3),setTimeout(()=>{D.disabled=!1,B.textContent="Data pH berhasil diunduh."},1500)):x==="humidity"&&(D.disabled=!0,B.textContent="Mengunduh data kelembapan...",setTimeout(async()=>{await pe()},4e3),setTimeout(()=>{D.disabled=!1,B.textContent="Data humidity berhasil diunduh."},1500)),setTimeout(()=>{A.classList.add("hidden"),L.classList.add("hidden"),x=null},5e3)});W.addEventListener("click",()=>{A.classList.add("hidden"),L.classList.add("hidden"),x=null});ae.addEventListener("click",()=>{M.classList.add("hidden"),O.classList.add("hidden")});window.addEventListener("click",function(e){!A.classList.contains("hidden")&&!L.classList.contains("hidden")?!Te.contains(e.target)&&e.target!==D&&e.target!==W&&e.target!==V&&e.target!==q&&(A.classList.add("hidden"),L.classList.add("hidden"),x=null):!M.classList.contains("hidden")&&!O.classList.contains("hidden")&&!Le.contains(e.target)&&e.target!==D&&e.target!==re&&e.target!==ae&&e.target!==W&&e.target!==V&&e.target!==q&&(M.classList.add("hidden"),O.classList.add("hidden"))});function ie(){const e=moment(),n=e.hour(),a=e.minute(),i=e.second(),o=e.format("HH : mm : ss");document.getElementById("clock").textContent=o;let t;n<7||n===7&&a===0&&i===0?t=moment().hour(7).minute(0).second(0):t=moment().add(1,"days").hour(7).minute(0).second(0),n===7&&a===0&&i===0&&nyalakanPompa();const s=moment.duration(t.diff(e)),r=String(s.hours()).padStart(2,"0"),c=String(s.minutes()).padStart(2,"0"),d=String(s.seconds()).padStart(2,"0"),m=`${r}`,u=`${c}`,h=`${d}`;document.getElementById("countdownHour").textContent=m,document.getElementById("countdownMinute").textContent=u,document.getElementById("countdownSecond").textContent=h}setInterval(ie,1e3);ie();
