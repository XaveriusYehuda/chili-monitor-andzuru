(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=a(t);fetch(t.href,o)}})();const ce="SensorMonitorDB",de=1,f="humidityUpdates",y="phUpdates";let p;function le(){return new Promise((e,n)=>{const a=indexedDB.open(ce,de);a.onerror=r=>{console.error("Error opening IndexedDB:",r.target.errorCode),n(r.target.errorCode)},a.onsuccess=r=>{p=r.target.result,console.log("IndexedDB opened successfully"),e(p)},a.onupgradeneeded=r=>{const t=r.target.result;t.objectStoreNames.contains(y)||(t.createObjectStore(y,{keyPath:"id",autoIncrement:!0}),console.log(`Object store '${y}' created.`)),t.objectStoreNames.contains(f)||(t.createObjectStore(f,{keyPath:"id",autoIncrement:!0}),console.log(`Object store '${f}' created.`))}})}function ue(e){if(!p){console.warn("IndexedDB not open. Cannot save pH data.");return}if(!e||typeof e!="object"){console.warn("Invalid pH data. Not saving to IndexedDB.");return}"id"in e&&delete e.id;const r=p.transaction([y],"readonly").objectStore(y).openCursor(null,"prev");r.onsuccess=t=>{const o=t.target.result;if(o&&o.value.phValue===e.phValue){console.warn("pH data is a duplicate of the immediately previous record. Not saving.");return}const c=p.transaction([y],"readwrite").objectStore(y).add(e);c.onsuccess=()=>{console.log("pH data successfully saved to IndexedDB.")},c.onerror=l=>{console.error("Error saving pH data to IndexedDB:",l.target.errorCode)}},r.onerror=t=>{console.error("Error checking for duplicate pH data in IndexedDB:",t.target.errorCode)}}function me(e){if(!p){console.warn("IndexedDB not open. Cannot save humidity data.");return}if(!e||typeof e!="object"){console.warn("Invalid humidity data. Not saving to IndexedDB.");return}"id"in e&&delete e.id;const r=p.transaction([f],"readonly").objectStore(f).openCursor(null,"prev");r.onsuccess=t=>{const o=t.target.result;if(o&&o.value.humidityValue===e.humidityValue){console.warn("Humidity data is a duplicate of the immediately previous record. Not saving.");return}const c=p.transaction([f],"readwrite").objectStore(f).add(e);c.onsuccess=()=>{console.log("Humidity data successfully saved to IndexedDB.")},c.onerror=l=>{console.error("Error saving Humidity data to IndexedDB:",l.target.errorCode)}},r.onerror=t=>{console.error("Error checking for duplicate humidityValue in IndexedDB:",t.target.errorCode)}}function Z(e=8){return new Promise((n,a)=>{if(!p){console.warn("IndexedDB not open. Cannot get data."),n([]);return}const o=p.transaction([f],"readonly").objectStore(f).openCursor(null,"prev"),i=[];o.onsuccess=s=>{const c=s.target.result;c&&i.length<e?(i.push(c.value),c.continue()):n(i)},o.onerror=s=>{console.error("Error getting data from IndexedDB:",s.target.errorCode),a(s.target.errorCode)}})}function ee(e=8){return new Promise((n,a)=>{if(!p){console.warn("IndexedDB not open. Cannot get data."),n([]);return}const o=p.transaction([y],"readonly").objectStore(y).openCursor(null,"prev"),i=[];o.onsuccess=s=>{const c=s.target.result;c&&i.length<e&&(i.push(c.value),c.continue())},o.onerror=s=>{console.error("Error getting data from IndexedDB:",s.target.errorCode),a(s.target.errorCode)}})}function ge(e="ph_data.csv"){return new Promise((n,a)=>{if(!p){console.warn("IndexedDB not open. Cannot get data."),a("IndexedDB not open");return}const o=p.transaction([y],"readonly").objectStore(y).openCursor();let i=[],s=[],c=!0;o.onsuccess=l=>{const m=l.target.result;if(m){const u=m.value;c&&(s=Object.keys(u),i.push(s.join(",")),c=!1);const h=s.map(b=>{let d=u[b];return d===null||typeof d>"u"?"":typeof d=="string"&&(d.includes(",")||d.includes('"')||d.includes(`
`))?`"${d.replace(/"/g,'""')}"`:d}).join(",");i.push(h),m.continue()}else{console.log("semua data telah diiterasi");const u=i.join(`
`),h=new Blob([u],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(h),d=document.createElement("a");d.href=b,d.download=e,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(b),console.log(`Data exported to ${e}`),n()}},o.onerror=l=>{console.error("Error download data from IndexedDB:",l.target.errorCode),a(l.target.errorCode)}})}function pe(e="humidity_data.csv"){return new Promise((n,a)=>{if(!p){console.warn("IndexedDB not open. Cannot get data."),a("IndexedDB not open");return}const o=p.transaction([f],"readonly").objectStore(f).openCursor();let i=[],s=[],c=!0;o.onsuccess=l=>{const m=l.target.result;if(m){const u=m.value;c&&(s=Object.keys(u),i.push(s.join(",")),c=!1);const h=s.map(b=>{let d=u[b];return d===null||typeof d>"u"?"":typeof d=="string"&&(d.includes(",")||d.includes('"')||d.includes(`
`))?`"${d.replace(/"/g,'""')}"`:d}).join(",");i.push(h),m.continue()}else{console.log("semua data telah diiterasi");const u=i.join(`
`),h=new Blob([u],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(h),d=document.createElement("a");d.href=b,d.download=e,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(b),console.log(`Data exported to ${e}`),n()}},o.onerror=l=>{console.error("Error download data from IndexedDB:",l.target.errorCode),a(l.target.errorCode)}})}const he="ae2f0qpfo130e-ats.iot.ap-southeast-1.amazonaws.com",te="ap-southeast-1",be="ap-southeast-1:66f016b1-04c1-4719-8774-bf55d732f161";AWS.config.region=te;AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:be});let E;const fe=async()=>{try{await new Promise((n,a)=>{AWS.config.credentials.get(r=>{r?a(r):n()})}),console.log("‚úÖ Cognito Credentials loaded.");const e=ye.getSignedUrl(he,te,AWS.config.credentials.accessKeyId,AWS.config.credentials.secretAccessKey,AWS.config.credentials.sessionToken);E=mqtt.connect(e,{reconnectPeriod:5e3,clientId:"webclient_"+Math.floor(Math.random()*1e4),protocol:"wss",clean:!0}),E.on("connect",()=>{console.log("‚úÖ MQTT connected")}),E.on("error",n=>{console.error("‚ùå MQTT Error:",n)})}catch(e){console.error("‚ùå Gagal load Cognito credentials:",e)}};window.nyalakanPompa=()=>{if(!E||!E.connected){console.error("üö´ MQTT belum terkoneksi. Tidak bisa publish.");return}const e=moment().format("YYYY-MM-DD HH:mm:ss"),n=document.getElementById("flushButton");n.classList.add("opacity-80"),n.disabled=!0,n.textContent="Sending ...",setTimeout(()=>{n.textContent="Flushing ..."},2e3),setTimeout(()=>{n.classList.remove("opacity-80"),n.disabled=!1,n.textContent="Flush"},3e4);const a=JSON.stringify({action:"nyala"});E.publish("device/pompa",a,{qos:1},r=>{r?console.error("üö´ Publish error:",r):console.log("üì§ Pompa nyala command dikirim pada",e)})};const ye={getSignedUrl:function(e,n,a,r,t){const o=new Date,i=o.toISOString().slice(0,10).replace(/-/g,""),s=o.toISOString().replace(/[:-]|\.\d{3}/g,""),c="iotdevicegateway",l="AWS4-HMAC-SHA256",m="GET",u="/mqtt",h=i+"/"+n+"/"+c+"/aws4_request",b="X-Amz-Algorithm="+l+"&X-Amz-Credential="+encodeURIComponent(a+"/"+h)+"&X-Amz-Date="+s+"&X-Amz-SignedHeaders=host",d="host:"+e+`
`,P=AWS.util.crypto.sha256("","hex"),j=m+`
`+u+`
`+b+`
`+d+`
host
`+P,k=l+`
`+s+`
`+h+`
`+AWS.util.crypto.sha256(j,"hex"),C=AWS.util.crypto.hmac(AWS.util.crypto.hmac(AWS.util.crypto.hmac(AWS.util.crypto.hmac("AWS4"+r,i,"buffer"),n,"buffer"),c,"buffer"),"aws4_request","buffer"),R=AWS.util.crypto.hmac(C,k,"hex");let N="wss://"+e+u+"?"+b+"&X-Amz-Signature="+R;return t&&(N+="&X-Amz-Security-Token="+encodeURIComponent(t)),N}};let v;const oe=()=>{if(v&&v.readyState!==WebSocket.CLOSED&&v.readyState!==WebSocket.CLOSING){console.log("WebSocket sudah aktif. Tidak membuat koneksi baru.");return}const e="wss://chili-monitor-data.andzuru.space";v=new WebSocket(e),v.onopen=async()=>{console.log("‚úÖ WebSocket connected to",e)},v.onmessage=n=>{try{const a=JSON.parse(n.data);console.log("üì® Data diterima:",a);const{topic:r,data:t,chartData:o,timestamp:i}=a,{ph:s,humidity:c}=o||{};let l=null;if(s&&Array.isArray(s.timestamps)&&s.timestamps.length>0){let g=s.timestamps[s.timestamps.length-1];typeof g=="string"&&g?l=new Date(g).toISOString():typeof g=="number"&&!isNaN(g)&&(g<1e10&&(g*=1e3),l=new Date(g).toISOString())}let m=null;if(c&&Array.isArray(c.timestamps)&&c.timestamps.length>0){let g=c.timestamps[c.timestamps.length-1];typeof g=="string"&&g?m=new Date(g).toISOString():typeof g=="number"&&!isNaN(g)&&(g<1e10&&(g*=1e3),m=new Date(g).toISOString())}const u=Date.now(),h=isNaN(Number(i))?0:u-Number(i),b=isNaN(Number(i))?null:new Date(Number(i)+7*60*60*1e3).toISOString(),d=new Date(u+7*60*60*1e3).toISOString();let P,j;t&&(t.Kelembapan!==void 0&&t.Kelembapan!==null&&!isNaN(parseFloat(t.Kelembapan))?(window.latestRecordHumidity={timestampCloudReceived:b,timestampBrowserReceived:d,latency:parseFloat(h),humidityValue:parseFloat(t.Kelembapan),humidityDataReceivedAt:m},P=window.latestRecordHumidity):console.log("Kelembapan tidak ada pembaharuan data"),t.Ph!==void 0&&t.Ph!==null&&!isNaN(parseFloat(t.Ph))?(window.latestRecordPh={timestampCloudReceived:b,timestampBrowserReceived:d,latency:parseFloat(h),phValue:parseFloat(t.Ph),phDataReceivedAt:l},j=window.latestRecordPh):console.log("PH tidak ada pembaharuan data"));const k=parseFloat((t==null?void 0:t.Ph)??"NaN"),C=parseFloat((t==null?void 0:t.Kelembapan)??"NaN"),R=isNaN(k)?"N/A":k.toFixed(1),N=isNaN(C)?"N/A":C.toFixed(1),K=document.getElementById("phValue"),Y=document.getElementById("humidityValue"),z=document.getElementById("ground-good-status"),_=document.getElementById("ground-poor-status");if(!isNaN(k)&&!isNaN(C)&&(k>8.5||k<5.5||C>90||C<10)?(z.classList.add("hidden"),_.classList.remove("hidden")):(_.classList.add("hidden"),z.classList.remove("hidden")),K&&(K.textContent=R),Y&&(Y.textContent=N),o){if(s&&Array.isArray(s.timestamps)&&Array.isArray(s.values)){const g=s.timestamps.map(Number),F=s.values.map(Number);navigator.onLine?(ve(g,F),ue(j)):ee(1).then(T=>{T&&T.length>0&&setTimeout(we,200)})}if(c&&Array.isArray(c.timestamps)&&Array.isArray(c.values)){const g=c.timestamps.map(Number),F=c.values.map(Number);navigator.onLine?(xe(g,F),me(P)):Z(1).then(T=>{T&&T.length>0&&setTimeout(De,200)})}}}catch(a){console.error("‚ùå Error parsing WebSocket message:",a)}},v.onerror=n=>{console.error("‚ö†Ô∏è WebSocket error:",n)},v.onclose=n=>{console.warn(`‚ö†Ô∏è WebSocket disconnected. Code: ${n.code}, Reason: ${n.reason}`),setTimeout(()=>{console.log("üîÅ Mencoba reconnect WebSocket..."),oe()},5e3)}},G="BEr7RhsHyH-U39qwfNHjCgsxD3_cBFL17xttbkvTWYbavxeJoED-IKkSf1Ui4CUYiIdGsNeknYBqeEjVuIFQgFc";function J(e){const n="=".repeat((4-e.length%4)%4),a=(e+n).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(a),t=new Uint8Array(r.length);for(let o=0;o<r.length;++o)t[o]=r.charCodeAt(o);return t}async function Q(e,n){if(!n)throw console.error("No auth token found"),new Error("Authentication token is missing.");const a="https://chili-monitor-data.andzuru.space/api/save-subscription";console.log("Preparing subscription data for backend...");const r=e.getKey("p256dh"),t=e.getKey("auth");if(!r||!t)throw console.error("Subscription keys are missing"),new Error("Subscription keys are missing");const o={endpoint:e.endpoint,keys:{p256dh:btoa(String.fromCharCode(...new Uint8Array(r))),auth:btoa(String.fromCharCode(...new Uint8Array(t)))}};console.log("Sending subscription to backend:",o);try{const i=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(o)}),s=await i.json();if(!i.ok)throw console.error("Backend subscription error:",s),new Error(s.message||"Failed to send subscription to backend");return console.log("Backend subscription successful:",s),s}catch(i){throw console.error("Subscription error:",i),i}}async function X(e,n){if(!n)throw console.error("No auth token found"),new Error("Authentication token is missing.");const a="https://chili-monitor-data.andzuru.space/api/delete-subscription",r={endpoint:e};try{const t=await fetch(a,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(r)}),o=await t.json();if(!t.ok)throw new Error(o.message||"Failed to send unsubscription to backend");return console.log("Unsubscription sent to backend successfully:",o),o}catch(t){throw console.error("Error sending unsubscription to backend:",t),t}}async function $(){if(!("serviceWorker"in navigator)||!("PushManager"in window))return{supported:!1,subscribed:!1,error:"Push notification not supported"};try{const n=await(await navigator.serviceWorker.ready).pushManager.getSubscription();return{supported:!0,subscribed:!!n,subscriptionObject:n}}catch{return{supported:!0,subscribed:!1,error:"Failed to check subscription status."}}}function I(e){const n=document.getElementById("subscribeBtn"),a=document.getElementById("subscribeBtnMobile");n&&a&&(e?(n.textContent="Unsubscribe",n.classList.remove("text-primary","hover:text-tersier"),n.classList.add("bg-primary","px-6","text-white","rounded-full","transition-colors","hover:text-primary","hover:bg-white"),a.textContent="Unsubscribe",a.classList.remove("group-hover:text-tersier"),a.classList.add("bg-primary","px-6","text-white","rounded-full","transition-colors","hover:text-primary","hover:bg-white")):(n.textContent="Subscribe",n.classList.remove("bg-primary","px-6","text-white","rounded-full","hover:bg-white","hover:text-primary"),n.classList.add("text-primary","hover:text-tersier"),a.textContent="Subscribe",a.classList.remove("bg-primary","px-6","text-white","rounded-full","hover:bg-white","hover:text-primary"),a.classList.add("group-hover:text-tersier")))}async function ne(){if(!("serviceWorker"in navigator)||!("PushManager"in window)){console.warn("Push notification tidak didukung.");return}try{const e=await navigator.serviceWorker.register("/sw.js");if(console.log("Service Worker terdaftar:",e),await Notification.requestPermission()==="denied"){console.warn("Izin notifikasi tidak diberikan"),I(!1);return}const a=await $();I(a.subscribed)}catch(e){console.error("Gagal setup push notification:",e)}}async function Se(e,n,a){try{const r=await fetch("https://chili-monitor-data.andzuru.space/api/register-auto-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:n,password:a})}),t=await r.json();return r.ok&&t.success?(console.log("Registration successful, token received:",t.token),localStorage.setItem("userToken",t.token),alert("Registrasi berhasil! Anda telah otomatis login."),await ne(),!0):(console.error("Registration failed:",t.message||"Unknown error"),alert(`Registrasi gagal: ${t.message||"Terjadi kesalahan."}`),!1)}catch(r){return console.error("Error during registration:",r),alert("Terjadi kesalahan saat registrasi."),!1}}document.addEventListener("DOMContentLoaded",async()=>{oe(),fe(),le().then(()=>{}).catch(r=>console.error("Failed to open IndexedDB:",r));let e=localStorage.getItem("userToken");e?console.log("User token found in localStorage:",e):(console.log("No user token found. Attempting to auto-register and login for experiment."),await Se("experimentaluser","experimental@example.com","password123")?(e=localStorage.getItem("userToken"),console.log("Auto-registration and login successful. Token:",e)):console.error("Auto-registration and login failed.")),await ne();const n=document.getElementById("subscribeBtn"),a=document.getElementById("subscribeBtnMobile");n&&n.addEventListener("click",async()=>{const r=localStorage.getItem("userToken");if(!r){alert("Silakan login atau daftar terlebih dahulu untuk berlangganan notifikasi.");return}const t=await $();if(t.subscribed)try{await X(t.subscriptionObject.endpoint,r),await t.subscriptionObject.unsubscribe(),console.log("Successfully unsubscribed!"),I(!1),alert("You have successfully unsubscribed from push notifications.")}catch(o){console.error("Error unsubscribing:",o),alert("Failed to unsubscribe. Please try again.")}else try{const o=await navigator.serviceWorker.ready,i=J(G),s=await o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:i});await Q(s,r),console.log("Successfully subscribed!"),I(!0),alert("You have successfully subscribed to push notifications!")}catch(o){console.error("Error subscribing:",o),alert("Failed to subscribe. Please ensure notifications are enabled and try again.")}}),a&&a.addEventListener("click",async()=>{const r=localStorage.getItem("userToken");if(!r){alert("Silakan login atau daftar terlebih dahulu untuk berlangganan notifikasi.");return}const t=await $();if(t.subscribed)try{await X(t.subscriptionObject.endpoint,r),await t.subscriptionObject.unsubscribe(),console.log("Successfully unsubscribed (Mobile)!"),I(!1),alert("You have successfully unsubscribed from push notifications.")}catch(o){console.error("Error unsubscribing (Mobile):",o),alert("Failed to unsubscribe. Please try again.")}else try{const o=await navigator.serviceWorker.ready,i=J(G),s=await o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:i});await Q(s,r),console.log("Successfully subscribed (Mobile)!"),I(!0),alert("You have successfully subscribed to push notifications!")}catch(o){console.error("Error subscribing (Mobile):",o),alert("Failed to subscribe. Please ensure notifications are enabled and try again.")}})});async function we(){const e=await ee();if(!e||e.length===0){S.data.datasets[0].data=[],S.data.labels=[],S.update();return}const n=e.slice().reverse(),a=n.map(t=>{const o=new Date(t.phDataReceivedAt),i=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),c=String(o.getDate()).padStart(2,"0"),l=String(o.getHours()).padStart(2,"0"),m=String(o.getMinutes()).padStart(2,"0"),u=String(o.getSeconds()).padStart(2,"0");return`${i}-${s}-${c} ${l}:${m}:${u}`}),r=n.map(t=>t.phValue);S.data.datasets[0].data=r,S.data.labels=a,S.update()}function ve(e,n){function a(t){const o=new Date(t),i=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),c=String(o.getDate()).padStart(2,"0"),l=String(o.getHours()).padStart(2,"0"),m=String(o.getMinutes()).padStart(2,"0"),u=String(o.getSeconds()).padStart(2,"0");return`${i}-${s}-${c} ${l}:${m}:${u}`}const r=e.map(t=>a(t));S.data.datasets[0].data=n,S.data.labels=r,S.update()}const ke={labels:[],datasets:[{label:"Soil pH",data:[],borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",borderWidth:2}]},Ce={type:"line",data:ke,options:{scales:{y:{beginAtZero:!1}}}},S=new Chart(document.getElementById("myChart1"),Ce);async function De(){const e=await Z();if(!e||e.length===0){w.data.datasets[0].data=[],w.data.labels=[],w.update();return}const n=e.slice().reverse(),a=n.map(t=>{const o=new Date(t.humidityDataReceivedAt),i=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),c=String(o.getDate()).padStart(2,"0"),l=String(o.getHours()).padStart(2,"0"),m=String(o.getMinutes()).padStart(2,"0"),u=String(o.getSeconds()).padStart(2,"0");return`${i}-${s}-${c} ${l}:${m}:${u}`}),r=n.map(t=>t.humidityValue);w.data.datasets[0].data=r,w.data.labels=a,w.update()}function xe(e,n){function a(t){const o=new Date(t),i=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),c=String(o.getDate()).padStart(2,"0"),l=String(o.getHours()).padStart(2,"0"),m=String(o.getMinutes()).padStart(2,"0"),u=String(o.getSeconds()).padStart(2,"0");return`${i}-${s}-${c} ${l}:${m}:${u}`}const r=e.map(t=>a(t));console.log(r),w.data.datasets[0].data=n,w.data.labels=r,w.update()}const Ie={labels:[],datasets:[{label:"Soil Moisture",data:[],borderColor:"rgba(54, 162, 235, 1)",backgroundColor:"rgba(54, 162, 235, 0.2)",borderWidth:2}]},Be={type:"line",data:Ie,options:{scales:{y:{beginAtZero:!1}}}},w=new Chart(document.getElementById("myChart"),Be),H=document.querySelector("#hamburger"),U=document.querySelector("#nav-menu");H.addEventListener("click",function(){H.classList.toggle("hamburger-active"),U.classList.toggle("hidden")});window.addEventListener("click",function(e){e.target!=H&&e.target!=U&&(H.classList.remove("hamburger-active"),U.classList.add("hidden"))});const M=document.getElementById("modal-container-1"),O=document.getElementById("modal-container-2"),L=document.getElementById("modal-confirm-download-container"),A=document.getElementById("modal-confirm-download-alert"),Ee=document.getElementById("modal-main"),Le=document.getElementById("modal-main-download"),re=document.getElementById("info-button"),ae=document.getElementById("close-modal"),D=document.getElementById("download-data"),W=document.getElementById("cancel-download"),V=document.getElementById("get-ph-data-modal"),q=document.getElementById("get-humidity-data-modal"),B=document.getElementById("content-download-modal"),se=document.getElementById("title-download-modal");let x=null;re.addEventListener("click",()=>{M.classList.remove("hidden"),O.classList.remove("hidden")});V.addEventListener("click",()=>{L.classList.remove("hidden"),A.classList.remove("hidden"),x="ph",se.textContent="Download PH Data",B.textContent="Do you want to download the pH data?"});q.addEventListener("click",()=>{L.classList.remove("hidden"),A.classList.remove("hidden"),x="humidity",se.textContent="Download Humidity Data",B.textContent="Do you want to download the humidity data?"});D.addEventListener("click",()=>{x==="ph"?(D.disabled=!0,B.textContent="Mengunduh data pH...",setTimeout(async()=>{await ge()},4e3),setTimeout(()=>{D.disabled=!1,B.textContent="Data pH berhasil diunduh."},1500)):x==="humidity"&&(D.disabled=!0,B.textContent="Mengunduh data kelembapan...",setTimeout(async()=>{await pe()},4e3),setTimeout(()=>{D.disabled=!1,B.textContent="Data humidity berhasil diunduh."},1500)),setTimeout(()=>{L.classList.add("hidden"),A.classList.add("hidden"),x=null},5e3)});W.addEventListener("click",()=>{L.classList.add("hidden"),A.classList.add("hidden"),x=null});ae.addEventListener("click",()=>{M.classList.add("hidden"),O.classList.add("hidden")});window.addEventListener("click",function(e){!L.classList.contains("hidden")&&!A.classList.contains("hidden")?!Le.contains(e.target)&&e.target!==D&&e.target!==W&&e.target!==V&&e.target!==q&&(L.classList.add("hidden"),A.classList.add("hidden"),x=null):!M.classList.contains("hidden")&&!O.classList.contains("hidden")&&!Ee.contains(e.target)&&e.target!==D&&e.target!==re&&e.target!==ae&&e.target!==W&&e.target!==V&&e.target!==q&&(M.classList.add("hidden"),O.classList.add("hidden"))});function ie(){const e=moment(),n=e.hour(),a=e.minute(),r=e.second(),t=e.format("HH : mm : ss");document.getElementById("clock").textContent=t;let o;n<7||n===7&&a===0&&r===0?o=moment().hour(7).minute(0).second(0):o=moment().add(1,"days").hour(7).minute(0).second(0),n===7&&a===0&&r===0&&nyalakanPompa();const i=moment.duration(o.diff(e)),s=String(i.hours()).padStart(2,"0"),c=String(i.minutes()).padStart(2,"0"),l=String(i.seconds()).padStart(2,"0"),m=`${s}`,u=`${c}`,h=`${l}`;document.getElementById("countdownHour").textContent=m,document.getElementById("countdownMinute").textContent=u,document.getElementById("countdownSecond").textContent=h}setInterval(ie,1e3);ie();
